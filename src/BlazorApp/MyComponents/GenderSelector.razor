@using Microsoft.AspNetCore.Components
@using Microsoft.Extensions.Localization
@using PensionCoach.Tools.CommonTypes

@inject IStringLocalizer<PensionComponents> localizer

<MudSelect Disabled="@IsReadOnly" Label="@Label" @bind-Value="@SelectedGender">

    @foreach (var g in genderModels)
    {
        <MudSelectItem Value="g.Value">@g.Name</MudSelectItem>
    }
</MudSelect>

@code {
    internal class GenderViewModel
    {
        public Gender Value { get; set; }

        public string Name { get; set;}
    }

    [Parameter]
    public string Label { get; set; }

    [Parameter]
    public bool IsReadOnly { get; set; }

    [Parameter]
    public Gender SelectedGender { get; set; } = Gender.Undefined;

    [Parameter]
    public EventCallback<Gender> OnSelected { get; set; }

    private readonly List<GenderViewModel> genderModels = new();

    protected override void OnInitialized()
    {
        genderModels.Add(new GenderViewModel { Name = localizer["gender.male"], Value = Gender.Male });
        genderModels.Add(new GenderViewModel { Name = localizer["gender.female"], Value = Gender.Female });
    }

    private void HandleChange(object value)
    {
        SelectedGender = (Gender)value;
        OnSelected.InvokeAsync(SelectedGender);
    }

    private GenderViewModel GetViewModel()
    {
        return genderModels.Single(item => item.Value == SelectedGender);
    }
}
