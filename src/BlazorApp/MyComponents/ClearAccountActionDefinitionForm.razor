@using Microsoft.AspNetCore.Components
@using PensionCoach.Tools.CommonTypes
@using PensionCoach.Tools.CommonTypes.MultiPeriod
@using PensionCoach.Tools.CommonTypes.MultiPeriod.Actions
@using PensionCoach.Tools.CommonTypes.MultiPeriod.Definitions
@using PensionCoach.Tools.CommonTypes.Tax
@using System.Globalization
@using Domain.Enums

@inject IStringLocalizer<Resource> Localizer

<EditForm Model="Definition">
    <MudGrid>
        <MudItem md="12">
            <MudTextField T="string" Label="Titel" Text="@Definition.Header.Name"/>
            <MudDatePicker Label="Datum" @bind-Date="@dateOfTransferIn" DateFormat="dd.MM.yyyy" />
            <MudNumericField Label="Anteil" Format="p2" Step="0.005M" @bind-Value="@Definition.TransferRatio" Culture="CultureInfo.InvariantCulture" />
            <MudSwitch Label="Steuerbar" @bind-Checked="@Definition.IsTaxable" Color="Color.Primary" />
        </MudItem>
    </MudGrid>
</EditForm>

@code {

    [Parameter]
    public RelativeTransferAmountDefinition Definition { get; set; }

    private DateTime? dateOfTransferIn;

    protected override void OnInitialized()
    {
        Definition.Flow = new FlowPair(AccountType.OccupationalPension, AccountType.Wealth);
        Definition.TaxType = TaxType.CapitalBenefits;
        Definition.IsTaxable = true;
        Definition.Header = new CashFlowHeader()
        {
            Id = Guid.NewGuid().ToString(),
            Name = "Kapitalbezug"
        };
        Definition.TransferRatio = 1M;
    }
}
